<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞ (A-Frame WebXR)</title>

  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>

  <style>
    body { margin: 0; font-family: sans-serif; }
    #infoPanel {
      position: absolute;
      right: 16px;
      top: 16px;
      width: 260px;
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 12px;
      border-radius: 8px;
      z-index: 20;
      font-size: 14px;
      display: none;
    }
    #infoPanel h3 { margin: 0 0 6px 0; font-size: 16px }
    #infoPanel p { margin: 6px 0 }
    #closeInfo { cursor: pointer; background:#333; padding:4px 8px; border-radius:4px }
    
    #overlay { position:absolute; width:100%; height:100%; z-index:5; pointer-events:none; }
  </style>
</head>

<body>

  <div id="overlay"></div>

  <div id="infoPanel">
    <h3 id="infoTitle"></h3>
    <p id="infoText"></p>
    <div style="text-align:right"><span id="closeInfo">‡∏õ‡∏¥‡∏î</span></div>
  </div>

  <a-scene
    xr-mode-ui="enabled: true"
    webxr="optionalFeatures: ['hit-test']; requiredFeatures: ['dom-overlay']; dom-overlay: #overlay;"
    renderer="colorManagement: true; physicallyCorrectLights: true; alpha: true">

    <a-sky id="sky" src="textures/stars.jpg"></a-sky>

    <a-entity id="sun-parent" position="0 0 0">
      <a-sphere id="sun" radius="1.2" src="textures/sun.jpg"
                material="shader: flat"></a-sphere>
      <a-animation attribute="rotation" to="0 360 0" dur="20000" repeat="indefinite"></a-animation>
    </a-entity>

    <a-entity light="type: ambient; intensity: 0.3"></a-entity>
    <a-entity light="type: point; intensity: 2; distance: 80" position="0 0 0"></a-entity>

    <!-- üëÄ Camera + Pinch Zoom -->
    <a-entity id="cameraRig" pinch-zoom position="0 1.6 7">
      <a-entity camera look-controls wasd-controls>
        <a-entity cursor="fuse:false; rayOrigin:mouse"
                  raycaster="objects: .clickable"
                  position="0 0 -1"
                  geometry="primitive:ring; radiusInner:0.01; radiusOuter:0.02"
                  material="color:#fff"></a-entity>
      </a-entity>
    </a-entity>

    <!-- Mercury -->
    <a-entity id="orbit-mercury">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:1.6; radiusOuter:1.61"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:8000; loop:true">
        <a-sphere class="clickable" radius="0.08" position="1.6 0 0"
                  src="textures/mercury.jpg"
                  data-name="Mercury"
                  data-info="‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏î‡∏ß‡∏á‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î"></a-sphere>
      </a-entity>
    </a-entity>

    <!-- Venus -->
    <a-entity id="orbit-venus">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:2.3; radiusOuter:2.31"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:14000; loop:true">
        <a-sphere class="clickable" radius="0.14" position="2.3 0 0"
                  src="textures/venus.jpg"
                  data-name="Venus"
                  data-info="‡∏î‡∏≤‡∏ß‡∏®‡∏∏‡∏Å‡∏£‡πå ‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î"></a-sphere>
      </a-entity>
    </a-entity>

    <!-- Earth + Moon -->
    <a-entity id="orbit-earth">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:3.2; radiusOuter:3.21"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity id="earth-system" animation="property:rotation; to:0 360 0; dur:22000; loop:true">

        <a-sphere id="earth" class="clickable"
                  radius="0.18"
                  position="3.2 0 0"
                  src="textures/earth.jpg"
                  data-name="Earth"
                  data-info="‡πÇ‡∏•‡∏Å ‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏°‡∏µ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï"></a-sphere>

        <a-entity id="moon-orbit" position="3.2 0 0"
                  animation="property:rotation; to:0 360 0; dur:3000; loop:true">

          <a-sphere radius="0.05"
                    position="0.25 0 0"
                    class="clickable"
                    src="textures/moon.jpg"
                    data-name="Moon"
                    data-info="‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÇ‡∏•‡∏Å"></a-sphere>

        </a-entity>
      </a-entity>
    </a-entity>


    <!-- Mars -->
    <a-entity id="orbit-mars">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:4.1; radiusOuter:4.11"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:32000; loop:true">
        <a-sphere radius="0.12" position="4.1 0 0" class="clickable"
                  src="textures/mars.jpg"
                  data-name="Mars"
                  data-info="‡∏î‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏µ‡πÅ‡∏î‡∏á"></a-sphere>
      </a-entity>
    </a-entity>

    <!-- Jupiter -->
    <a-entity id="orbit-jupiter">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:5.6; radiusOuter:5.61"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:44000; loop:true">
        <a-sphere radius="0.5" position="5.6 0 0" class="clickable"
                  src="textures/jupiter.jpg"
                  data-name="Jupiter"
                  data-info="‡∏î‡∏≤‡∏ß‡πÅ‡∏Å‡πä‡∏™‡∏¢‡∏±‡∏Å‡∏©‡πå"></a-sphere>
      </a-entity>
    </a-entity>

    <!-- Saturn -->
    <a-entity id="orbit-saturn">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:7.0; radiusOuter:7.01"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:56000; loop:true">
        <a-entity position="7 0 0">
          <a-sphere radius="0.42" class="clickable"
                    src="textures/saturn.jpg"
                    data-name="Saturn"
                    data-info="‡∏î‡∏≤‡∏ß‡πÄ‡∏™‡∏≤‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏ß‡∏á‡πÅ‡∏´‡∏ß‡∏ô"></a-sphere>

          <a-ring src="textures/saturn_ring.jpg"
                  rotation="90 0 0"
                  radius-inner="0.55"
                  radius-outer="0.9"
                  material="opacity:0.9"></a-ring>
        </a-entity>
      </a-entity>
    </a-entity>

    <!-- Uranus -->
    <a-entity id="orbit-uranus">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:8.6; radiusOuter:8.61"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:68000; loop:true">
        <a-sphere radius="0.3" position="8.6 0 0" class="clickable"
                  src="textures/uranus.jpg"
                  data-name="Uranus"
                  data-info="‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏≠‡∏µ‡∏¢‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î"></a-sphere>
      </a-entity>
    </a-entity>

    <!-- Neptune -->
    <a-entity id="orbit-neptune">
      <a-entity rotation="-90 0 0" geometry="primitive:ring; radiusInner:10; radiusOuter:10.01"
                material="color:#555; opacity:0.2"></a-entity>

      <a-entity animation="property:rotation; to:0 360 0; dur:82000; loop:true">
        <a-sphere radius="0.32" position="10 0 0" class="clickable"
                  src="textures/neptune.jpg"
                  data-name="Neptune"
                  data-info="‡∏î‡∏≤‡∏ß‡πÄ‡∏ô‡∏õ‡∏à‡∏π‡∏ô"></a-sphere>
      </a-entity>
    </a-entity>

  </a-scene>

  <script>
    /* ---------- ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏≤‡∏ß ---------- */
    document.querySelectorAll('.clickable').forEach(el => {
      el.addEventListener('click', e => {
        const planet = e.detail.intersectedEl;
        document.getElementById('infoTitle').innerText = planet.dataset.name;
        document.getElementById('infoText').innerText  = planet.dataset.info;
        document.getElementById('infoPanel').style.display = 'block';
      });
    });

    document.getElementById('closeInfo').onclick = () => {
      document.getElementById('infoPanel').style.display = 'none';
    };

    /* ---------- ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° sky ‡∏ï‡∏≠‡∏ô AR ---------- */
    const scene = document.querySelector("a-scene");
    const sky = document.getElementById("sky");

    scene.addEventListener("enter-ar", () => {
      sky.setAttribute("visible", "false");
    });

    scene.addEventListener("exit-ar", () => {
      sky.setAttribute("visible", "true");
    });

    /* ==========================================================
       ‚≠ê‚≠ê‚≠ê  Pinch Zoom Component  ‚≠ê‚≠ê‚≠ê
       ========================================================== */
    AFRAME.registerComponent('pinch-zoom', {
      schema: { zoomSpeed: { default: 0.02 }, min: { default: 1 }, max: { default: 10 } },

      init: function () {
        this.isPinching = false;
        this.startDistance = 0;
        this.currentZoom = 7;   // ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á
        this.camera = this.el;  // ‡πÉ‡∏ä‡πâ cameraRig ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
      },

      tick: function () {
        const canvas = this.el.sceneEl.canvas;
        if (!canvas || !canvas.touches || canvas.touches.length < 2) return;

        const [t1, t2] = canvas.touches;

        const dx = t1.clientX - t2.clientX;
        const dy = t1.clientY - t2.clientY;
        const distance = Math.sqrt(dx*dx + dy*dy);

        if (!this.isPinching) {
          this.startDistance = distance;
          this.isPinching = true;
          return;
        }

        const delta = distance - this.startDistance;
        this.startDistance = distance;

        this.currentZoom -= delta * this.data.zoomSpeed;

        this.currentZoom = Math.min(this.data.max, Math.max(this.data.min, this.currentZoom));

        this.camera.object3D.position.z = this.currentZoom;
      }
    });

  </script>
</body>
</html>
